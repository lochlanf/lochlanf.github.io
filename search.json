[
  {
    "objectID": "W2_2.html#learning-objectives",
    "href": "W2_2.html#learning-objectives",
    "title": "4  Week 2 Workshop B - Quality control inspection of sequencing reads",
    "section": "4.1 Learning Objectives",
    "text": "4.1 Learning Objectives\nAt the conclusion of today’s workshop students are expected to be able to:\n\nUnderstand the role of quality control in pre-processing sequencing data\nApply common bioinformatic tools to interrogate the quality of sequencing reads\nCritically evaluate common quality control metrics and propose solutions based on these metrics"
  },
  {
    "objectID": "W2_2.html#workshop-setup",
    "href": "W2_2.html#workshop-setup",
    "title": "4  Week 2 Workshop B - Quality control inspection of sequencing reads",
    "section": "4.2 Workshop setup",
    "text": "4.2 Workshop setup\nTo download today’s workshop data enter the following commands\n\ncd ~\nmkdir GNA5012/week2_5\ncd GNA5012/week2_5\nln -s /home/ubuntu/week_2/data\nmkdir src results\nmkdir results/fastqc\n\nThe last command in this series creates a “symbolic link”. A symbolic link is like a shortcut. This provides you access to the data, which resides in /home/ubuntu/week_2/data, and will be used over the course of the next few weeks. Note that you can read these files but you cannot modify them (this is to prevent any inadvertent deletions or edits to the raw data!\nWe will use symbolic links a few times over the next few weeks to link to large raw data files and reference genomes.\nAs you work through today’s exercises, remember to add comments to your code using the # symbol. You should convey what the script and commands are trying to achieve. This will also make it easier to deploy these scripts to analyse data for your upcoming assessment."
  },
  {
    "objectID": "W2_2.html#sequencing-data-quality-control-metrics",
    "href": "W2_2.html#sequencing-data-quality-control-metrics",
    "title": "4  Week 2 Workshop B - Quality control inspection of sequencing reads",
    "section": "4.3 Sequencing data quality control metrics",
    "text": "4.3 Sequencing data quality control metrics\nWe can use the fastqc tool to rapidly assess the quality of our sequencing and inform downstream quality control processing. Below are a list of the metrics that fastqc reports provide.\n\nPer Base Sequence Quality: This metric evaluates the quality scores of each base position in the reads. Quality scores are typically represented as Phred scores, which quantify the base-calling error probability. Lower Phred scores indicate lower confidence in the base call and may suggest poor sequencing quality.\n\nPotential cause: In a low-quality region, the Phred scores may drop below a certain threshold (e.g., below 20), leading to increased chances of base-calling errors. This can arise due to issues like sequencing machine malfunctions, low-quality sequencing reagents, or problems with the sample preparation process.\n\nPer Sequence Quality Scores: This metric presents a graph showing the distribution of average quality scores across all sequences in the dataset. It helps identify whether the majority of sequences have high or low average quality scores.\n\nPotential cause: If the graph shows a skewed distribution towards low average quality scores, it may indicate that a significant portion of the data contains poor quality reads. This could be due to issues such as over-amplification during library preparation, contamination, or sequencing artifacts.\n\nPer Base Sequence Content: This metric assesses the percentage of each base position that corresponds to specific nucleotides (A, C, G, or T). It helps identify potential biases or contamination in the sequencing data.\n\nPotential cause: A sudden drop in the percentage of a specific nucleotide at certain positions may suggest sequencing-specific biases or contaminants. This could arise from technical artifacts, PCR biases, or even contamination during sample handling. Tagmentation based libraries will usually show a non-uniform per base sequence content in the first 20 nucleotides of reads.\n\nPer Base GC Content: This metric analyzes the distribution of GC content across all reads. Deviations from the expected GC content may indicate potential issues.\n\nPotential cause: If the GC content distribution shows a bimodal pattern, it could indicate a mixed sample, adapter contamination, or PCR amplification biases.\n\nSequence Duplication Levels: This metric assesses the percentage of duplicate sequences in the dataset. High duplication levels may indicate PCR amplification biases or over-representation of certain regions in the genome.\n\nExample: If a significant portion of the data comprises duplicate reads, it might suggest PCR artifacts, library preparation biases, or issues during sample indexing. Some libraries, such as RNAseq libraries, will have biological sequence duplication owing to gene expression patterns. It is important to consider this before deduplicating data.\n\nOverrepresented Sequences: FastQC flags sequences that are overrepresented in the dataset. Such sequences may indicate adapter contamination, PCR artifacts, or even contamination from other sources.\n\nPotential Cause: Overrepresented sequences could be adapter sequences or primer dimers that were not properly removed during library preparation or contaminants that originated from the experimental environment.\n\nAdapter content\n\nFastQC will perform an automatic analysis to determine the presence of common adapter sequences. If no adapters are present these lines should be flat. If you observe a steady rise in adapter content towards the end of a read, this is indicative of adapters on the reads."
  },
  {
    "objectID": "W2_2.html#performing-analysis-with-fastqc",
    "href": "W2_2.html#performing-analysis-with-fastqc",
    "title": "4  Week 2 Workshop B - Quality control inspection of sequencing reads",
    "section": "4.4 Performing analysis with FastQC",
    "text": "4.4 Performing analysis with FastQC\nIn today’s workshop, we will be analysing sequencing data from the Genome In A Bottle project. This project generated high quality variant calls on a number of reference samples using several sequencing modalities. The aim of the project was to create a “gold standard” to test genomic pipelines against, with the aim of achieving high sensitivity and specificity. In this workshop and over the coming weeks we will be evaluating whole exome sequencing data derived from the NA12878 cell line. DNA was extracted from this sample and exome sequencing libraries were prepared using the Nextera Rapid Capture Exome and Expanded Exome kit. Libraries were sequenced using paired-end sequencing on a HiSeq2500 sequencing instrument. The data provided has been demultiplexed, converted to fastq files, and gzipped. Let’s take a look at these sequencing reads.\n\nExercise 1: Explore the reads using standard bash tools.\n\nUse the zcat tool to read the gzipped fastq files. Pipe this to less and head to take a look at each file.\nUsing zcat, grep and wc, identify the number of sequences in each file. What do you notice?\n\n\nNow that we have a basic understanding of these files we can use fastqc to take a closer look at their quality. Here is an example of how to use fastqc:\nfastqc -o results ERR10129302.fastq.gz\nLet’s unpack this command. The fastqc command will initialise fastqc. The -o option specifies the output directory. If this is ran in the week2_5 directory, our results will go to week2_5/results. The final string is the name of the file we are analysing.\n\nExercise 2: Assess the quality of the reads using FastQC\n\nIn the src directory, which is where you should house all your scripts, create a script called fastqc.sh. Runfastqc on one of sequence files.\nMake sure you set the -o option to ~/GNA5012/week2_5/results/fastqc.\nUse winSCP or CyberDuck to download these files to your computer. If you are unsure of how to achieve this. If you are unsure how to do this, please review the following videos: winSCP (windows) / CyberDuck (Mac OSX). Make sure you select SFTP as the file transfer protocol. If you are still unsure, approach a tutor for assistance.\nOpen the file in a web browser and inspect the reports. Take note of any flags that have been raised.\nUsing the notes above, what are the possible causes of the fail and warning flags (Hint: you might want to check out how these libraries were created)? Would you propose doing any quality control based on this report. Discuss on your tables.\n\n\nYou will note that there are four sequence files in the data directory. This is paired-end sequencing data (as indicated by the R1 and R2 in the file names). We need to run fastqc on all the files. The most efficient way to achieve this is by writing a FOR loop using the * wildcard.\n\nExercise 3: Write a loop to perform FastQC on all the sequence files in the data directory\n\nIn the src directory, which is where you should house all your scripts, create a script called fastqc_loop.sh. Write a FOR loop to run fastqc on all the .fastq.gz files in the data directory.\nMake sure you set the -o option to ~/GNA5012/week2_5/results/fastqc.\nOpen the file in a web browser and inspect the reports. Take note of any flags that have been raised. We will discuss these as a group.\n\n\nNext week we will be performing quality control on these reads. Over the coming week, have a think about what quality control we should perform. Is there evidence of adapters? Should we quality trim reads? Should we discard any sequences? These are all decisions that we have to make in any sequencing experiment. You should justify your decisions and make notes of them in a README style document."
  }
]